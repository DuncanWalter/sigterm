import { defineEffect, Effect } from './effect'
import { Damage, targeted } from '../events/damage'
import { Listener, ConsumerArgs } from '../events/listener'
import { blockable } from '../events/damage'

export const Vulnerability: * = defineEffect(
  'vulnerability',
  {
    name: 'Vulnerability',
    innerColor: '#ee8866',
    outerColor: '#bb3322',
    description: 'Take 50% more damage from external sources.',
    sides: 3,
    rotation: 0.5,
  },
  {
    stacked: true,
    delta: (x) => x - 1,
    min: 1,
    max: 99,
  },
  (owner) => ({
    subjects: [owner],
    type: Damage,
    tags: [blockable],
  }),
  (owner, type) =>
    function*({ data }) {
      if (typeof data.damage == 'number') {
        data.damage *= 1.5
      }
    },
  [],
  [Damage]
)
